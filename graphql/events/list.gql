query getEvents(
  $filter: events_bool_exp
  $order: [events_order_by]
  $limit: Int
  $offset: Int
  $include_user: Boolean!
  $user_id: uuid!
) {
  events(where: $filter, order_by: $order, limit: $limit, offset: $offset) {
    # Basic info
    id
    title
    description
    created_at
    event_category_id
    # media
    banner_url

    # location
    location_address
    location_type
    location_link

    # schedule
    start_time_utc
    end_time_utc

    # event links
    event_links {
      id
      url
      platform
    }

    # Feed
    feed {
      id
      type
      created_at
      created_by
      visibility
      comment_count
      reaction_count
      share_count
      feed_reactions(where: { user_id: { _eq: $user_id } }, limit: 1)
        @include(if: $include_user) {
        id
        reaction_type
        user_id
        feed_id
      }
      user {
        id
        full_name
        profile_image
        avatar_color
      }

      page {
        id
        name
        description
        profile_image
        avatar_color

        page_followers(where: { user_id: { _eq: $user_id } }, limit: 1)
          @include(if: $include_user) {
          id
        }

        page_admins(where: { user_id: { _eq: $user_id } }, limit: 1)
          @include(if: $include_user) {
          id
          role
        }
      }
      group {
        id
        name
        description
        cover_image
        created_at
        updated_at
        avatar_color
        group_members(where: { user_id: { _eq: $user_id } }, limit: 1)
          @include(if: $include_user) {
          id
          role
          status
        }
      }
    }
  }

  events_aggregate(where: $filter) {
    aggregate {
      count
    }
  }
}
